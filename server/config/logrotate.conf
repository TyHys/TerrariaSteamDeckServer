# Logrotate Configuration for Terraria Server
# Rotates server logs to prevent disk space issues

# Terraria server logs
/terraria/logs/terraria-stdout.log
/terraria/logs/terraria-stderr.log
/terraria/logs/server.log
{
    # Rotate daily
    daily
    
    # Keep 7 days of logs
    rotate 7
    
    # Compress old logs
    compress
    delaycompress
    
    # Don't error if log is missing
    missingok
    
    # Don't rotate empty logs
    notifempty
    
    # Create new log file after rotation
    create 0644 terraria terraria
    
    # Copy and truncate (safer for actively written logs)
    copytruncate
    
    # Maximum size before rotation (even if not time yet)
    maxsize 50M
    
    # Minimum size before rotation
    minsize 1M
}

# Supervisor logs
/terraria/logs/supervisord.log
{
    daily
    rotate 3
    compress
    delaycompress
    missingok
    notifempty
    create 0644 root root
    copytruncate
    maxsize 10M
}

# Crash handler logs
/terraria/logs/crash-handler.log
/terraria/logs/crashes.log
{
    weekly
    rotate 12
    compress
    delaycompress
    missingok
    notifempty
    create 0644 terraria terraria
    copytruncate
    maxsize 5M
}

# Backup system logs
/terraria/logs/backup.log
/terraria/logs/restore.log
/terraria/logs/backup-scheduler.log
/terraria/logs/backup-scheduler-stdout.log
/terraria/logs/backup-scheduler-stderr.log
/terraria/logs/world-manager.log
{
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 terraria terraria
    copytruncate
    maxsize 10M
}

# Web API logs
/terraria/logs/web-api-stdout.log
/terraria/logs/web-api-stderr.log
{
    daily
    rotate 5
    compress
    delaycompress
    missingok
    notifempty
    create 0644 terraria terraria
    copytruncate
    maxsize 20M
}
