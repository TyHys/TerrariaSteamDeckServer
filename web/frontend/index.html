<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terraria Server Manager</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå≤</text></svg>">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            <div class="login-header">
                <div class="logo">üå≤</div>
                <h1>Terraria Server Manager</h1>
                <p class="subtitle">Steam Deck Edition</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" value="admin" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required autofocus>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <span class="btn-text">Login</span>
                    <span class="btn-loading hidden">Logging in...</span>
                </button>
                <div id="login-error" class="error-message hidden"></div>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app-screen" class="screen hidden">
        <!-- Navigation Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo-small">üå≤</div>
                <span class="app-title">Terraria Server</span>
            </div>
            <ul class="nav-menu">
                <li>
                    <a href="#dashboard" class="nav-link active" data-page="dashboard">
                        <span class="nav-icon">üìä</span>
                        <span class="nav-text">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="#worlds" class="nav-link" data-page="worlds">
                        <span class="nav-icon">üåç</span>
                        <span class="nav-text">Worlds</span>
                    </a>
                </li>
                <li>
                    <a href="#backups" class="nav-link" data-page="backups">
                        <span class="nav-icon">üíæ</span>
                        <span class="nav-text">Backups</span>
                    </a>
                </li>
                <li>
                    <a href="#config" class="nav-link" data-page="config">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span class="nav-text">Configuration</span>
                    </a>
                </li>
                <li>
                    <a href="#logs" class="nav-link" data-page="logs">
                        <span class="nav-icon">üìú</span>
                        <span class="nav-text">Logs</span>
                    </a>
                </li>
            </ul>
            <div class="sidebar-footer">
                <button id="logout-btn" class="btn btn-outline btn-sm">
                    <span class="nav-icon">üö™</span>
                    <span>Logout</span>
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <div class="page-title">
                    <h2 id="current-page-title">Dashboard</h2>
                </div>
                <div class="status-bar">
                    <div id="server-status-indicator" class="status-indicator offline">
                        <span class="status-dot"></span>
                        <span class="status-text">Checking...</span>
                    </div>
                    <button id="refresh-btn" class="btn btn-icon" title="Refresh">üîÑ</button>
                </div>
            </header>

            <!-- Page Container -->
            <div class="page-container">
                <!-- Dashboard Page -->
                <div id="page-dashboard" class="page active">
                    <div class="dashboard-grid">
                        <!-- Server Status Card -->
                        <div class="card card-status">
                            <div class="card-header">
                                <h3>Server Status</h3>
                            </div>
                            <div class="card-body">
                                <div id="server-status-display" class="status-display">
                                    <div class="status-icon offline">‚ö°</div>
                                    <div class="status-info">
                                        <span class="status-label">Server Status</span>
                                        <span id="server-status-text" class="status-value">Checking...</span>
                                    </div>
                                </div>
                                <div class="server-controls">
                                    <button id="btn-start" class="btn btn-success" disabled>
                                        <span>‚ñ∂ Start</span>
                                    </button>
                                    <button id="btn-stop" class="btn btn-danger" disabled>
                                        <span>‚èπ Stop</span>
                                    </button>
                                    <button id="btn-restart" class="btn btn-warning" disabled>
                                        <span>üîÑ Restart</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Info Card -->
                        <div class="card card-info">
                            <div class="card-header">
                                <h3>Server Info</h3>
                            </div>
                            <div class="card-body">
                                <div class="info-grid">
                                    <div class="info-item">
                                        <span class="info-label">World</span>
                                        <span id="info-world" class="info-value">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Port</span>
                                        <span id="info-port" class="info-value">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Max Players</span>
                                        <span id="info-players" class="info-value">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Password</span>
                                        <span id="info-password" class="info-value">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Health Check Card -->
                        <div class="card card-health">
                            <div class="card-header">
                                <h3>System Health</h3>
                                <button id="btn-health-check" class="btn btn-sm btn-outline">Check</button>
                            </div>
                            <div class="card-body">
                                <div id="health-checks" class="health-checks">
                                    <div class="health-item">
                                        <span class="health-name">Supervisor</span>
                                        <span id="health-supervisor" class="health-status">-</span>
                                    </div>
                                    <div class="health-item">
                                        <span class="health-name">Terraria Server</span>
                                        <span id="health-terraria" class="health-status">-</span>
                                    </div>
                                    <div class="health-item">
                                        <span class="health-name">Backup Scheduler</span>
                                        <span id="health-backup" class="health-status">-</span>
                                    </div>
                                    <div class="health-item">
                                        <span class="health-name">Disk Space</span>
                                        <span id="health-disk" class="health-status">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Disk Usage Card -->
                        <div class="card card-disk">
                            <div class="card-header">
                                <h3>Storage</h3>
                            </div>
                            <div class="card-body">
                                <div class="storage-items">
                                    <div class="storage-item">
                                        <span class="storage-label">üåç Worlds</span>
                                        <span id="disk-worlds" class="storage-value">-</span>
                                    </div>
                                    <div class="storage-item">
                                        <span class="storage-label">üíæ Backups</span>
                                        <span id="disk-backups" class="storage-value">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Activity Card -->
                        <div class="card card-activity">
                            <div class="card-header">
                                <h3>Quick Actions</h3>
                            </div>
                            <div class="card-body">
                                <div class="quick-actions">
                                    <button id="btn-quick-backup" class="btn btn-outline">
                                        <span>üíæ Create Backup</span>
                                    </button>
                                    <button id="btn-quick-world" class="btn btn-outline">
                                        <span>üåç New World</span>
                                    </button>
                                    <button id="btn-quick-logs" class="btn btn-outline">
                                        <span>üìú View Logs</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Worlds Page -->
                <div id="page-worlds" class="page hidden">
                    <div class="page-header">
                        <h3>World Management</h3>
                        <button id="btn-create-world" class="btn btn-primary">
                            <span>+ Create World</span>
                        </button>
                    </div>
                    <div class="page-content">
                        <div id="worlds-list" class="worlds-grid">
                            <div class="loading-state">Loading worlds...</div>
                        </div>
                    </div>
                </div>

                <!-- Backups Page -->
                <div id="page-backups" class="page hidden">
                    <div class="page-header">
                        <h3>Backup Management</h3>
                        <div class="header-actions">
                            <button id="btn-create-backup" class="btn btn-primary">
                                <span>+ Create Backup</span>
                            </button>
                            <button id="btn-cleanup-backups" class="btn btn-outline">
                                <span>üóë Cleanup</span>
                            </button>
                        </div>
                    </div>
                    <div class="backup-info-bar">
                        <span id="backup-count">0 backups</span>
                        <span id="backup-size">0 MB total</span>
                        <span id="backup-retention">Retention: - backups</span>
                    </div>
                    <div class="page-content">
                        <div id="backups-list" class="backups-table">
                            <div class="loading-state">Loading backups...</div>
                        </div>
                    </div>
                </div>

                <!-- Configuration Page -->
                <div id="page-config" class="page hidden">
                    <div class="page-header">
                        <h3>Server Configuration</h3>
                    </div>
                    <div class="page-content">
                        <form id="config-form" class="config-form">
                            <div class="config-section">
                                <h4>Server Settings</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="config-max-players">Max Players</label>
                                        <input type="number" id="config-max-players" name="max_players" min="1" max="255" value="8">
                                    </div>
                                    <div class="form-group">
                                        <label for="config-password">Server Password</label>
                                        <input type="password" id="config-password" name="password" placeholder="Leave empty for no password">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group full-width">
                                        <label for="config-motd">Message of the Day</label>
                                        <input type="text" id="config-motd" name="motd" placeholder="Welcome to the server!">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="config-difficulty">Default Difficulty</label>
                                        <select id="config-difficulty" name="difficulty">
                                            <option value="0">Classic</option>
                                            <option value="1">Expert</option>
                                            <option value="2">Master</option>
                                            <option value="3">Journey</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="config-autocreate">Default World Size</label>
                                        <select id="config-autocreate" name="autocreate">
                                            <option value="1">Small</option>
                                            <option value="2">Medium</option>
                                            <option value="3">Large</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="config-secure" name="secure" checked>
                                            <span>Enable Anti-Cheat</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="config-section">
                                <h4>Backup Settings</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="config-backup-enabled" name="backup_enabled" checked>
                                            <span>Enable Automatic Backups</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="config-backup-interval">Backup Interval (minutes)</label>
                                        <input type="number" id="config-backup-interval" name="backup_interval" min="1" max="1440" value="30">
                                    </div>
                                    <div class="form-group">
                                        <label for="config-backup-retention">Backups to Keep</label>
                                        <input type="number" id="config-backup-retention" name="backup_retention" min="1" max="1000" value="48">
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">Save Configuration</button>
                                <button type="button" id="btn-reload-config" class="btn btn-outline">Reload</button>
                            </div>
                            <div id="config-message" class="form-message hidden"></div>
                        </form>
                    </div>
                </div>

                <!-- Logs Page -->
                <div id="page-logs" class="page hidden">
                    <div class="page-header">
                        <h3>Server Logs</h3>
                        <div class="header-actions">
                            <select id="log-type-select">
                                <option value="server">Server Output</option>
                                <option value="error">Error Log</option>
                                <option value="supervisor">Supervisor</option>
                                <option value="crash">Crash Log</option>
                                <option value="backup">Backup Log</option>
                            </select>
                            <button id="btn-refresh-logs" class="btn btn-outline">
                                <span>üîÑ Refresh</span>
                            </button>
                        </div>
                    </div>
                    <div class="logs-toolbar">
                        <div class="logs-search">
                            <input type="text" id="logs-search-input" placeholder="Search logs...">
                            <button id="btn-search-logs" class="btn btn-sm btn-outline">Search</button>
                        </div>
                        <div class="logs-options">
                            <label>
                                <span>Lines:</span>
                                <select id="log-lines-select">
                                    <option value="50">50</option>
                                    <option value="100" selected>100</option>
                                    <option value="200">200</option>
                                    <option value="500">500</option>
                                </select>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="log-auto-refresh">
                                <span>Auto-refresh</span>
                            </label>
                        </div>
                    </div>
                    <div class="page-content logs-content">
                        <pre id="logs-viewer" class="logs-viewer">Loading logs...</pre>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal Container -->
    <div id="modal-container" class="modal-container hidden">
        <div class="modal-overlay"></div>
        <div class="modal">
            <div class="modal-header">
                <h3 id="modal-title">Modal Title</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div id="modal-body" class="modal-body">
                <!-- Modal content inserted here -->
            </div>
            <div id="modal-footer" class="modal-footer">
                <!-- Modal actions inserted here -->
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
